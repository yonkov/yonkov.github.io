<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport"    content="width=device-width, initial-scale=1.0">
	<meta name="description" content="In this article, I am going to show you some of the most amazing VBA Excel codes that you can use to optimize your work. VBA is a programming language, which can be used to extend the capabilities of MS Excel and other MS Office applications. It is extremely helpful for MS Excel users, because it can be used to automate your work and significantly improve your efficiency. This article will introduce you to VBA and show you some of the most useful, ready to use VBA codes out there.">
	<meta name="author"      content="Atanas Yonkov">
	<title>18 ready-to-use VBA Codes that will save your day</title>

	<link rel="shortcut icon" href="https://yonkov.github.io/images/gt_favicon.png">

	
	<link href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.no-icons.min.css" rel="stylesheet">
	
	
	<link rel="preload" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" as="style" onload="this.rel='stylesheet'">
	<noscript><link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"></noscript>
	
	
	<link rel="preload" href="https://fonts.googleapis.com/css?family=Alice|Open+Sans:400,300,700" as="style" onload="this.rel='stylesheet'">
	<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alice|Open+Sans:400,300,700"></noscript>
	
	
	<link rel="stylesheet" href="https://yonkov.github.io/css/styles.css">
	<link rel="preload" href="https://yonkov.github.io/css/custom.css" as="style" onload="this.rel='stylesheet'">
	<noscript><link rel="stylesheet" href="https://yonkov.github.io/css/custom.css"></noscript>
	
	<link href="https://yonkov.github.io/css/styles.css?v=1531519123" rel="stylesheet">
	
		<script>
		 
		(function(w){
	"use strict";
	 
	var loadCSS = function( href, before, media ){
		
		
		
			
		
		var doc = w.document;
		var ss = doc.createElement( "link" );
		var ref;
		if( before ){
			ref = before;
		}
		else {
			var refs = ( doc.body || doc.getElementsByTagName( "head" )[ 0 ] ).childNodes;
			ref = refs[ refs.length - 1];
		}

		var sheets = doc.styleSheets;
		ss.rel = "stylesheet";
		ss.href = href;
		
		ss.media = "only x";

		
		function ready( cb ){
			if( doc.body ){
				return cb();
			}
			setTimeout(function(){
				ready( cb );
			});
		}
		
			
			
		ready( function(){
			ref.parentNode.insertBefore( ss, ( before ? ref : ref.nextSibling ) );
		});
		
		var onloadcssdefined = function( cb ){
			var resolvedHref = ss.href;
			var i = sheets.length;
			while( i-- ){
				if( sheets[ i ].href === resolvedHref ){
					return cb();
				}
			}
			setTimeout(function() {
				onloadcssdefined( cb );
			});
		};

		function loadCB(){
			if( ss.addEventListener ){
				ss.removeEventListener( "load", loadCB );
			}
			ss.media = media || "all";
		}

		
		if( ss.addEventListener ){
			ss.addEventListener( "load", loadCB);
		}
		ss.onloadcssdefined = onloadcssdefined;
		onloadcssdefined( loadCB );
		return ss;
	};
	
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ));
		
		 
	(function( w ){
	  
	  if( !w.loadCSS ){
		return;
	  }
	  var rp = loadCSS.relpreload = {};
	  rp.support = function(){
		try {
		  return w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
		  return false;
		}
	  };

	  
	  rp.poly = function(){
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
		  var link = links[ i ];
		  if( link.rel === "preload" && link.getAttribute( "as" ) === "style" ){
			w.loadCSS( link.href, link, link.getAttribute( "media" ) );
			link.rel = null;
		  }
		}
	  };

	  
	  if( !rp.support() ){
		rp.poly();
		var run = w.setInterval( rp.poly, 300 );
		if( w.addEventListener ){
		  w.addEventListener( "load", function(){
			rp.poly();
			w.clearInterval( run );
		  } );
		}
		if( w.attachEvent ){
		  w.attachEvent( "onload", function(){
			w.clearInterval( run );
		  } );
		}
	  }
	}( this ));
	</script>	
</head>
<body class="home">

<header id="header">
	<div id="head" class="parallax" parallax-speed="2">
		<h1 id="logo" class="text-center">
			<img class="img-circle" src="https://yonkov.github.io/images/guy.jpg" alt="me">
			<span class="title">Atanas Yonkov</span>
			<span class="tagline">Blogger, Web Developer<br>
				<a href="">yonkov.atanas@gmail.com</a>
            </span>
		</h1>
	</div>
    <nav class="navbar navbar-default navbar-sticky">
    <div class="container-fluid">

        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="true">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <div class="navbar-collapse collapse" id="bs-example-navbar-collapse-1">

            <ul class="nav navbar-nav">
                
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/post">Blog</a>
                </li>
                
                <li>
                    <a href="/about/">About</a>
                </li>
                
                <li>
                    <a href="/privacy-policy/">Privacy Policy</a>
                </li>
                
				
    
    <li>
		<span class="language-switcher" style=""> 
		<i class="fa fa-globe"></i>
		<a href ="https://yonkov.github.io/ru/post/18-ready-to-use-vba-codes-that-will-save-your-day/" style="">ru:   </a>
		</span>
    </li>
    

            </ul>

        </div>
    </div>
</nav>

</header>
<main id="main">

	<div class="container">

		<div class="row topspace">
			<div class="col-sm-8 col-sm-offset-2">

 				<article class="post">
					<header class="entry-header">
 						
 						<h1 class="entry-title"><a href="https://yonkov.github.io/post/18-ready-to-use-vba-codes-that-will-save-your-day/" rel="bookmark">18 ready-to-use VBA Codes that will save your day</a></h1>
						<div class="entry-meta">
 							<span class="posted-on"><time class="entry-date published" date="2017-11-21 21:02:46 &#43;0200 EET">November 21, 2017</time></span>
 						</div>
					</header>
					<div class="entry-content">
						

<p>In this article, I am going to show you some of the most amazing VBA Excel codes that you can use to optimize your work. VBA is a programming language, which can be used to extend the capabilities of MS Excel and other MS Office applications. It is extremely helpful for MS Excel users, because it can be used to automate your work and significantly improve your efficiency. This article will introduce you to VBA and show you some of the most useful, ready to use VBA codes out there. You can use these macro examples to create your own scripts that fit your own needs.</p>

<p>You do not need programming experience to take advantage of the information in this article, but you are expected to have basic knowledge of Excel. If you are a beginner user, I would recommend you to read the article  <a href="https://yonkov.github.io/post/20-excel-formulas-you-should-start-using-now/">20 Excel Formulas You Should Start Using Now</a> to learn more about Excel&rsquo;s core functionalities.
<div style="text-align: center;">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- Yonkov.github.io -->
    <ins class="adsbygoogle"
         style="display:inline-block;width:336px;height:280px"
         data-ad-client="ca-pub-8282934831170709"
         data-ad-slot="5289224002"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div></p>

<p>I have prepared for you a number of ready to use VBA Excel Macro examples with great functionality that you can use to optimize your work. In order to use them, you need to “install” them in your Excel file. The next paragraph deals with Excel macro installation. Skip this part if you are already familiar with this.
<div>
	<header>
		<h5 style="margin: 0 0 10px 23px;">Table of Contents</h5>
	</header>
	<nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#1-copy-data-from-one-file-to-another">1. Copy data from one file to another.</a></li>
<li><a href="#2-show-hidden-rows">2. Show hidden rows</a></li>
<li><a href="#3-delete-empty-rows-and-columns">3. Delete empty rows and columns</a></li>
<li><a href="#4-find-a-blank-cell">4. Find a blank cell</a></li>
<li><a href="#5-replace-empty-cells-with-a-value">5. Replace empty cells with a value.</a></li>
<li><a href="#6-sort-numbers">6. Sort numbers</a></li>
<li><a href="#7-remove-empty-spaces">7. Remove empty spaces</a></li>
<li><a href="#8-highlight-dublicated-values">8. Highlight dublicated values</a></li>
<li><a href="#9-highlight-top-ten-values">9. Highlight top ten values</a></li>
<li><a href="#10-highlight-greater-than-values">10. Highlight greater than values</a></li>
<li><a href="#11-highlight-cells-with-comments">11. Highlight cells with comments</a></li>
<li><a href="#12-highlight-cells-with-misspelled-words">12. Highlight Cells with Misspelled words</a></li>
<li><a href="#13-create-a-pivot-table">13. Create a pivot table</a></li>
<li><a href="#14-attach-active-workbook-in-an-email">14. Attach active workbook in an Email</a></li>
<li><a href="#15-send-all-excel-charts-to-a-powerpoint-presentation">15. Send all Excel charts to a PowerPoint presentation</a></li>
<li><a href="#16-send-excel-table-in-ms-word">16. Send Excel table in MS Word</a></li>
<li><a href="#17-extract-a-specific-word-from-a-cell">17. Extract a specific word from a cell</a></li>
<li><a href="#18-protect-your-workbook">18. Protect your Workbook</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
</div>
<h4>How to install a macro</h4>
In Excel, press the key combination alt + F11. This will take you to the VBA editor in MS Excel. Then, right-click on the Microsoft Excel Objects folder on the left and select Insert =&gt; Module. This is the place where the macros are stored. To make use of the macro, you need to save the Excel document as macro-enabled. From the tab file =&gt; save as, choose save as macro-enabled workbook (the .xlsm extension) Now, it&rsquo;s time to write your first macro!</p>

<h4 id="1-copy-data-from-one-file-to-another">1. Copy data from one file to another.</h4>

<div style="text-align: center;">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- Yonkov.github.io -->
    <ins class="adsbygoogle"
         style="display:inline-block;width:336px;height:280px"
         data-ad-client="ca-pub-8282934831170709"
         data-ad-slot="5289224002"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<p>Very useful macro, as it shows how to copy a range of data from inside vba and how to create and name a new workbook. You can easily upgrade it to fit your own requirements:</p>

<pre><code>Sub CopyFiletoAnotherWorkbook()
'Copy the data
    Sheets(&quot;Example 1&quot;).Range(&quot;B4:C15&quot;).Copy
'Create a new workbook
    Workbooks.Add
'Paste the data
    ActiveSheet.Paste
'Turn off application alerts
    Application.DisplayAlerts = False
'Save the newly file. Change the name of the directory.
    ActiveWorkbook.SaveAs Filename:=&quot;C:\Temp\MyNewBook.xlsx&quot;
'Turn application alerts back on
    Application.DisplayAlerts = True
End Sub
</code></pre>

<h4 id="2-show-hidden-rows">2. Show hidden rows</h4>

<p>Occasionally, large Excel files contain hidden lines for better clarity. Here&rsquo;s a macro that will unhide all rows from an active worksheet:</p>

<pre><code>Sub ShowHiddenRows()
Columns.EntireColumn.Hidden = False
Rows.EntireRow.Hidden = False
End Sub
</code></pre>

<h4 id="3-delete-empty-rows-and-columns">3. Delete empty rows and columns</h4>

<p>Blank rows in Excel are a problem with data processing. Here is how to get rid of them:</p>

<pre><code>Sub DeleteEmptyRowsAndColumns()
'Declare your variables.
    Dim MyRange As Range
    Dim iCounter As Long
'Define the target Range.
    Set MyRange = ActiveSheet.UsedRange
    'Start reverse looping through the range of Rows.
    For iCounter = MyRange.Rows.Count To 1 Step -1
'If entire row is empty then delete it.
       If Application.CountA(Rows(iCounter).EntireRow) = 0 Then
           Rows(iCounter).Delete
           'Remove comment to See which are the empty rows
           'MsgBox &quot;row &quot; &amp; iCounter &amp; &quot; is empty&quot;
       End If
'Increment the counter down
    Next iCounter
'Step 6:  Start reverse looping through the range of Columns.
    For iCounter = MyRange.Columns.Count To 1 Step -1
'Step 7: If entire column is empty then delete it.
           If Application.CountA(Columns(iCounter).EntireColumn) = 0 Then
            Columns(iCounter).Delete
           End If
'Step 8: Increment the counter down
    Next iCounter       
End Sub
</code></pre>

<h4 id="4-find-a-blank-cell">4. Find a blank cell</h4>

<pre><code>Sub FindEmptyCell()
ActiveCell.Offset(1, 0).Select
   Do While Not IsEmpty(ActiveCell)
      ActiveCell.Offset(1, 0).Select
   Loop
End Sub
</code></pre>

<h4 id="5-replace-empty-cells-with-a-value">5. Replace empty cells with a value.</h4>

<div style="text-align: center;">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- Yonkov.github.io -->
    <ins class="adsbygoogle"
         style="display:inline-block;width:336px;height:280px"
         data-ad-client="ca-pub-8282934831170709"
         data-ad-slot="5289224002"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<p>As previously mentioned, blank cells interfere with data processing and the creation of pivot tables. Here is a code which replaces all blank cells with 0. This macro has a very large application because you can use it to find and replace N/A results, as well as other characters such as dots, commas or duplicate values:</p>

<pre><code>Sub FindAndReplace()
'Declare your variables
    Dim MyRange As Range
    Dim MyCell As Range
'Save the Workbook before changing cells?
    Select Case MsgBox(&quot;Can't Undo this action.  &quot; &amp; _
                        &quot;Save Workbook First?&quot;, vbYesNoCancel)
        Case Is = vbYes
        ThisWorkbook.Save
        Case Is = vbCancel
        Exit Sub
    End Select
'Define the target Range.
    Set MyRange = Selection
'Start looping through the range.
    For Each MyCell In MyRange
'Check for zero length then add 0.
        If Len(MyCell.Value) = 0 Then
            MyCell = 0
        End If
'Get the next cell in the range
    Next MyCell
End Sub
</code></pre>

<h4 id="6-sort-numbers">6. Sort numbers</h4>

<p>The following macro sorts in ascending order all numbers from the active cell’s column. Just double click any cell from a column you would like to sort.
NB: You need to put the code in Sheet 1 and not in a module to work:</p>

<pre><code>Private Sub Worksheet_BeforeDoubleClick (ByVal Target as Range, Cancel As Boolean)
'Declare your Variables
    Dim LastRow As Long
'Find last row
    LastRow = Cells (Rows.Count, 1) .End (xlUp) .Row
'Sort ascending on double-clicked column
    Rows (&quot;6:&quot; &amp; LastRow) .Sort _
    Key1: = Cells (6, ActiveCell.Column), _
    Order1: = xlAscending
End Sub
</code></pre>

<h4 id="7-remove-empty-spaces">7. Remove empty spaces</h4>

<p>Occasionally, data in the workbook contains additional spaces (spaces) that can interfere with data analysis and to corrupt of formulas. Here&rsquo;s a macro that will remove all the spaces from a preselected range of cells:</p>

<pre><code>Sub TrimTheSpaces()
'Declare your variables
    Dim MyRange As Range
    Dim MyCell As Range
'Save the Workbook before changing cells
    Select Case MsgBox(&quot;Can't Undo this action.  &quot; &amp; _
                        &quot;Save Workbook First?&quot;, vbYesNoCancel)
        Case Is = vbYes
        ThisWorkbook.Save
        Case Is = vbCancel
        Exit Sub
    End Select
'Define the target Range.
    Set MyRange = Selection
'Start looping through the range.
    For Each MyCell In MyRange
'Trim the Spaces.
        If Not IsEmpty(MyCell) Then
            MyCell = Trim(MyCell)
        End If
'Get the next cell in the range
    Next MyCell
End Sub
</code></pre>

<h4 id="8-highlight-dublicated-values">8. Highlight dublicated values</h4>

<p>Sometimes there are duplicate values in the several columns we would like to illuminate. Here&rsquo;s a macro that does just that:</p>

<pre><code>Sub HighlightDuplicates()
'Declare your variables
    Dim MyRange As Range
    Dim MyCell As Range
'Define the target Range.
    Set MyRange = Selection 
'Start looping through the range.
    For Each MyCell In MyRange 
'Ensure the cell has Text formatting.
        If WorksheetFunction.CountIf(MyRange, MyCell.Value) &gt; 1 Then
            MyCell.Interior.ColorIndex = 36
        End If
'Get the next cell in the range
    Next MyCell
End Sub
</code></pre>

<h4 id="9-highlight-top-ten-values">9. Highlight top ten values</h4>

<p>This code will highlight the top ten values from a selection of cells:</p>

<pre><code>Sub TopTen()
Selection.FormatConditions.AddTop10
Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1)
        .TopBottom = xlTop10Top
        'Change the rank here to highlight a different number of values
        .Rank = 10
        .Percent = False
    End With
    With Selection.FormatConditions(1).Font
        .Color = -16752384
        .TintAndShade = 0
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
        .TintAndShade = 0
    End With
Selection.FormatConditions(1).StopIfTrue = False
End Sub
</code></pre>

<p>You can easily tweak the code to highlight different number of values.</p>

<h4 id="10-highlight-greater-than-values">10. Highlight greater than values</h4>

<p>When you run this code, a window will prompt. It will ask you the value you want to compare the cells you have selected.</p>

<pre><code>Sub HighlightGreaterThanValues()
Dim i As Integer
i = InputBox(&quot;Enter Greater Than Value&quot;, &quot;Enter Value&quot;)
Selection.FormatConditions.Delete
'Change the Operator to xlLower to highlight lower than values
Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, Formula1:=i
Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1)
        .Font.Color = RGB(0, 0, 0)
        .Interior.Color = RGB(31, 218, 154)
    End With
End Sub
</code></pre>

<p>You can tweak this code to highlight lower values as well.</p>

<h4 id="11-highlight-cells-with-comments">11. Highlight cells with comments</h4>

<p>A simple macro that highlights all the cells that contain comments:</p>

<pre><code>Sub highlightCommentCells()
Selection.SpecialCells(xlCellTypeComments).Select
Selection.Style= &quot;Note&quot;
End Sub
</code></pre>

<h4 id="12-highlight-cells-with-misspelled-words">12. Highlight Cells with Misspelled words</h4>

<p>This is extremely useful when you work with functions that take strings, however, someone entered the string with a mistake and your formulas are not working. Here is how to fix this issue:</p>

<pre><code>Sub ColorMispelledCells()
For Each cl In ActiveSheet.UsedRange
    If Not Application.CheckSpelling(Word:=cl.Text) Then _
    cl.Interior.ColorIndex = 28
Next cl
End Sub
</code></pre>

<h4 id="13-create-a-pivot-table">13. Create a pivot table</h4>

<p>Here is how to create a pivot table from MS Excel (2007 version). Especially useful, when you are making a custom report every day. You can optimize the pivot table creation in the following way:</p>

<pre><code>Sub PivotTableForExcel2007()
Dim SourceRange As Range
Set SourceRange = Sheets(&quot;Sheet1&quot;).Range(&quot;A3:N86&quot;)
ActiveWorkbook.PivotCaches.Create( _
SourceType:=xlDatabase, _
SourceData:=SourceRange, _
Version:=xlPivotTableVersion12).CreatePivotTable _
TableDestination:=&quot;&quot;, _
TableName:=&quot;&quot;, _
DefaultVersion:=xlPivotTableVersion12
End Sub
</code></pre>

<h4 id="14-attach-active-workbook-in-an-email">14. Attach active workbook in an Email</h4>

<p>My favorite VBA code. It lets you attach and send the file you&rsquo;re working on with a predefined email address, message title, and message body! You first need to set reference to Microsoft Outlook  (in your VBA editior, click on tools =&gt; references and choose Microsoft Outlook).</p>

<pre><code>Sub SendFIleAsAttachment()
'Declare your variables
'Set reference to Microsoft Outlook Object library
    Dim OLApp As Outlook.Application
    Dim OLMail As Object
'Open Outlook start a new mail item
    Set OLApp = New Outlook.Application
    Set OLMail = OLApp.CreateItem(0)
    OLApp.Session.Logon  
'Build your mail item and send
    With OLMail
    .To = &quot;admin@datapigtechnologies.com; mike@datapigtechnologies.com&quot;
    .CC = &quot;&quot;
    .BCC = &quot;&quot;
    .Subject = &quot;This is the Subject line&quot;
    .Body = &quot;Hi there&quot;
    .Attachments.Add ActiveWorkbook.FullName
    .Display  'Change to .Send to send without reviewing
    End With
'Memory cleanup
    Set OLMail = Nothing
    Set OLApp = Nothing
End Sub
</code></pre>

<h4 id="15-send-all-excel-charts-to-a-powerpoint-presentation">15. Send all Excel charts to a PowerPoint presentation</h4>

<p>A very handy macro that lets you add all your Excel charts in your Powerpoint presentation just with a single click:</p>

<pre><code>Sub SendExcelFiguresToPowerPoint()
'Set reference to Microsoft Powerpoint Object Library
'Declare your variables
    Dim PP As PowerPoint.Application
    Dim PPPres As PowerPoint.Presentation
    Dim PPSlide As PowerPoint.Slide
    Dim i As Integer
'Check for charts; exit if no charts exist
    Sheets(&quot;Slide Data&quot;).Select
        If ActiveSheet.ChartObjects.Count &lt; 1 Then
            MsgBox &quot;No charts existing the active sheet&quot;
            Exit Sub
        End If
'Open PowerPoint and create new presentation
    Set PP = New PowerPoint.Application
    Set PPPres = PP.Presentations.Add
    PP.Visible = True
'Start the loop based on chart count
        For i = 1 To ActiveSheet.ChartObjects.Count
        'Copy the chart as a picture
            ActiveSheet.ChartObjects(i).Chart.CopyPicture _
            Size:=xlScreen, Format:=xlPicture
            Application.Wait (Now + TimeValue(&quot;0:00:1&quot;))
        'Count slides and add new slide as next available slide number
            ppSlideCount = PPPres.Slides.Count
            Set PPSlide = PPPres.Slides.Add(SlideCount + 1, ppLayoutBlank)
            PPSlide.Select
        'Paste the picture and adjust its position; Go to next chart
            PPSlide.Shapes.Paste.Select
            PP.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True
            PP.ActiveWindow.Selection.ShapeRange.Align msoAlignMiddles, True
        Next i
'Memory Cleanup
    Set PPSlide = Nothing
    Set PPPres = Nothing
    Set PP = Nothing
End Sub
</code></pre>

<h4 id="16-send-excel-table-in-ms-word">16. Send Excel table in MS Word</h4>

<p>Excel tables are usually put inside text documents. Here is an automated way of exporting your Excel table to MS Word:</p>

<pre><code>Sub ExcelTableInWord()
'Set reference to Microsoft Word Object library
'Declare your variables
    Dim MyRange As Excel.Range
    Dim wd As Word.Application
    Dim wdDoc As Word.Document
    Dim WdRange As Word.Range
'Copy the defined range
   Sheets(&quot;Revenue Table&quot;).Range(&quot;B4:F10&quot;).Cop
'Open the target Word document
    Set wd = New Word.Application
    Set wdDoc = wd.Documents.Open _
    (ThisWorkbook.Path &amp; &quot;\&quot; &amp; &quot;PasteTable.docx&quot;)
    wd.Visible = True
'Set focus on the target bookmark
    Set WdRange = wdDoc.Bookmarks(&quot;DataTableHere&quot;).Rangе
'Delete the old table and paste new
    On Error Resume Next
    WdRange.Tables(1).Delete
    WdRange.Paste 'paste in the table   
'Adjust column widths
    WdRange.Tables(1).Columns.SetWidth _
    (MyRange.Width / MyRange.Columns.Count), wdAdjustSameWidth
'Reinsert the bookmark
    wdDoc.Bookmarks.Add &quot;DataTableHere&quot;, WdRange
'Memory cleanup
    Set wd = Nothing
    Set wdDoc = Nothing
    Set WdRange = Nothing
End Sub
</code></pre>

<h4 id="17-extract-a-specific-word-from-a-cell">17. Extract a specific word from a cell</h4>

<p>We can use formulas if we want to extract certain number of symbols. But what if we want to extract only the second word from a sentence or a range of words in a cell? To do this, we can create a custom Excel function with VBA. This is one of the most iportant VBA functionalities, because it lets you create your own functions that are non-existent in MS Excel. Let&rsquo;s go on and create two functions: findword() and findwordrev(). Here&rsquo;s the vba code for this:</p>

<pre><code>Function FindWord(Source As String, Position As Integer) As String
  On Error Resume Next
  FindWord = Split(WorksheetFunction.Trim(Source), &quot; &quot;)(Position - 1)
  On Error GoTo 0
End Function

Function FindWordRev(Source As String, Position As Integer) As String
  Dim Arr() As String
  Arr = VBA.Split(WorksheetFunction.Trim(Source), &quot; &quot;)
  On Error Resume Next
  FindWordRev = Arr(UBound(Arr) - Position + 1)
  On Error GoTo 0
End Function
</code></pre>

<p>Very nice, we have created two cstom Excel functions. Now, try to use them in Excel. The function = FindWordRev (A1,1) takes the last word from cell A1. The function = FindWord (A1,3) takes the third word from cell A1, etc.</p>

<h4 id="18-protect-your-workbook">18. Protect your Workbook</h4>

<p>Sometimes we want to protect the data in our file so that only we can change it. Here&rsquo;s how to do this with VBA:</p>

<pre><code>Sub ProtectSheets()
'Declare your variables
    Dim ws As Worksheet
'Start looping through all worksheets
    For Each ws In ActiveWorkbook.Worksheets
'Protect and loop to next worksheet
    ws.Protect Password:=&quot;1234&quot;
    Next ws
 End Sub
</code></pre>

<p>Congratulations! Since you are still reading this, you are really keen on learning VBA. As you have already seen for yourself, the VBA programming language is extremely useful and can save us a lot of time. I hope you found this information helpful and use it to become a master in MS Excel, VBA and computer software in general.</p>

<p>© 2017 Atanas Yonkov</p>

<hr>

<h6>Literature:</h6>

<h6>1. ExcelChamps.com: <a href="https://excelchamps.com/blog/useful-macro-codes-for-vba-newcomers">Top 100 Useful Excel Macro [VBA] Codes Examples.</a></h6>
<h6>2. Michael Alexander, John Walkenbach (2012). 101 Ready-To-Use Excel Macros.</h6>
<h6>3. BG Excel.info: 14 ready-to-use Macros for Excel.</h6>

					</div>
				</article>

			</div>
		</div> 
        <div class="row">
			<div class="col-sm-8 col-sm-offset-2">

				<div id="share">
                    
				</div>
			</div>
		</div> 
		<div class="clearfix"></div>

		<div class="row">
			<div class="col-sm-8 col-sm-offset-2">

				<div id="comments">
                    
				</div>
			</div>
		</div> 
		<div class="clearfix"></div>

	</div>	

</main>

<footer id="footer">
	<div class="container">
		<div class="row">
			<div class="col-md-3 widget">
				<h3 class="widget-title">Contact</h3>
				<div class="widget-body">
					<p><br>
						<a href="mailto:yonkov.atanas@gmail.com">yonkov.atanas@gmail.com</a><br>
						<br>
						
					</p>
				</div>
			</div>

			<div class="col-md-3 widget">
				<h3 class="widget-title">Follow me</h3>
				<div class="widget-body">
					<p class="follow-me-icons">
                        
                            
                                <a href="https://www.facebook.com/" target="_blank"><i class="fa fa-facebook-square fa-2"></i></a>
                            
                        
                            
                                <a href="https://twitter.com/" target="_blank"><i class="fa fa-twitter-square fa-2"></i></a>
                            
                        
                            
                                <a href="https://www.instagram.com/" target="_blank"><i class="fa fa-instagram fa-2"></i></a>
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                <a href="https://github.com/yonkov" target="_blank"><i class="fa fa-github fa-2"></i></a>
                            
                        
                            
                        
					</p>
				</div>
			</div>

			<div class="col-md-3 widget">
				<h3 class="widget-title">Personal Info</h3>
				<div class="widget-body">
					<p>Welcome to my professional website! I work as a devoted web developer and a freelancer. My ultimate goal is customer satisfaction. I focus on quality and creating value for my clients. </p>
					
				</div>
			</div>

			<div class="col-md-3 widget">
				<h3 class="widget-title">Form widget</h3>
				<div class="widget-body">
					<p><br>
						<a href="mailto:yonkov.atanas@gmail.com">yonkov.atanas@gmail.com</a><br>
						<br>
                        
					</p>
				</div>
			</div>

		</div> 
	</div>
</footer>

<footer id="underfooter">
	<div class="container">
		<div class="row">

			<div class="col-md-6 widget">
				<div class="widget-body">
					<p></p>
				</div>
			</div>

			<div class="col-md-6 widget">
				<div class="widget-body">
					<p class="text-right">
						Copyright &copy; 2017, Atanas Yonkov<br>
						Design: <a href="http://www.gettemplate.com" rel="designer">Initio by GetTemplate</a> - 
                        Powered by: <a href="https://gohugo.io/" rel="poweredby">Hugo</a>
                    </p>
				</div>
			</div>

		</div> 
	</div>
</footer>



    
      
    

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://yonkov.github.io/js/template.js"></script>

<script>
(function(i,s,o,g,r,a,m){i['TyxoObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//s.tyxo.com/c.js','tx');
tx('create', 'TX-927463385881');
tx('pageview');
</script>

<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#000"
    },
    "button": {
      "background": "#f1d600"
    }
  },
  "content": {
    "message": "This website uses cookies to analyze traffic and for advertisements. By continuing you agree to the use of these cookies.",
    "dismiss": "Ok, I accept",
    "href": "https://yonkov.github.io/privacy-policy"
  }
})});
</script>
</body>
</html>
